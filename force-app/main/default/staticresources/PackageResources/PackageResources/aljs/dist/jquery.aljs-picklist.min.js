if("undefined"==typeof jQuery.aljs)throw new Error("Please include the ALJS initializer file");!function(e){var s=function(s,o){this.$el=e(s),this.settings=o,this.obj={},this.bindTrigger(),this.bindChoices()};s.prototype={constructor:s,bindTrigger:function(){var s=this,o=this.$el;this.obj.$trigger=e(".slds-button",o),this.obj.$dropdown=e(".slds-dropdown",o),this.obj.$choices=e(".slds-dropdown__item a",o),this.obj.$trigger.unbind().click(function(o){return o.stopPropagation(),s.obj.id=e(this).attr("id"),s.$el.hasClass("slds-is-open")?(s.$el.removeClass("slds-is-open"),s.obj.$dropdown.unbind("keyup",s.processKeypress)):(e('[data-aljs="picklist"]').not(s.$el).picklist("close"),s.$el.addClass("slds-is-open"),null===s.obj.valueId||"undefined"==typeof s.obj.valueId?s.focusedIndex=null:s.focusedIndex=s.obj.$dropdown.find("li").index(s.obj.$dropdown.find("#"+s.obj.valueId)),s.focusOnElement(),s.obj.$dropdown.on("keyup",s,s.processKeypress)),!1}),e("body").click(function(){s.$el.removeClass("slds-is-open"),s.obj.$dropdown.unbind("keyup",s.processKeypress)}).keyup(function(s){27===s.keyCode&&e('[data-aljs="picklist"]').picklist("close")})},processKeypress:function(e){var s=e.data,o=s.obj.$choices.length;switch(e.keyCode){case 40:s.focusedIndex=s.focusedIndex===o-1?0:s.focusedIndex+1,s.focusOnElement();break;case 38:s.focusedIndex=0===s.focusedIndex?o-1:s.focusedIndex-1,s.focusOnElement();break;case 27:s.$el.picklist("close")}return!1},focusOnElement:function(){null!==this.focusedIndex&&this.obj.$choices.eq(this.focusedIndex).focus()},bindChoices:function(){var s=this;this.obj.$valueContainer=e("> span",this.obj.$trigger),this.obj.$choices.unbind().click(function(o){o.stopPropagation();var i=e(this).closest("li").attr("id");s.setValueAndUpdateDom(i),s.settings.onChange(s.obj)})},setValueAndUpdateDom:function(e){var s=this.$el.find("#"+e);this.obj.value=s.find("a").text(),this.obj.valueId=e,this.$el.removeClass("slds-is-open"),this.obj.$dropdown.unbind("keyup",this.processKeypress),this.obj.$trigger.trigger("change.aljs.picklist").focus(),this.obj.$valueContainer.text(this.obj.value),this.obj.$choices.parent().removeClass("slds-is-selected"),s.addClass("slds-is-selected")},setValue:function(e,s){this.setValueAndUpdateDom(e),s&&this.settings.onChange(this.obj)},getValueId:function(){return this.obj.valueId},getValue:function(){return this.obj},close:function(){this.$el.removeClass("slds-is-open"),this.obj.$dropdown.unbind("keyup",this.processKeypress)}},e.fn.picklist=function(o){var i,t=arguments,n=e.extend({assetsLocation:e.aljs.assetsLocation,onChange:function(e){}},"object"==typeof o?o:{});if(this.each(function(){var d=e(this),l=d.data("aljs-picklist");if(!l){var c=new s(this,n);d.data("aljs-picklist",l=c)}"string"==typeof o&&(i=l[o](t[1],t[2]))}),void 0===i||i instanceof s)return this;if(this.length>1)throw new Error("Using only allowed for the collection of a single element ("+option+" function)");return i}}(jQuery);